<?php

use Codeception\TestCase\Test;
use Synapse\UploadBundle\Repository\UploadColumnHeaderDownloadMapRepository;

class UploadColumnHeaderMapRepositoryTest extends Test
{
    use Codeception\Specify;

    /**
     * @var \Symfony\Component\DependencyInjection\Container
     */
    private $container;

    /**
     * @var \Synapse\CoreBundle\Repository\RepositoryResolver
     */
    private $repositoryResolver;

    /**
     * @var UploadColumnHeaderDownloadMapRepository
     */
    private $uploadColumnHeaderDownloadMapRepository;

    public function testGetUploadTemplateHeaders()
    {
        $this->markTestSkipped("To be fixed in ESPRJ-17639");
        $this->specify("Verify the functionality of the method getUploadTemplateHeaders", function ($uploadType, $downloadType, $expectedResult) {
            $this->container = $this->getModule('Symfony2')->kernel->getContainer();
            $this->repositoryResolver = $this->container->get('repository_resolver');
            $this->uploadColumnHeaderDownloadMapRepository = $this->repositoryResolver->getRepository(\Synapse\UploadBundle\Repository\UploadColumnHeaderDownloadMapRepository::REPOSITORY_KEY);
            try {
                $result = $this->uploadColumnHeaderDownloadMapRepository->getUploadHeaders($uploadType, $downloadType);
                $this->assertEquals($result, $expectedResult);
            } catch (\Exception $e) {
                $errorMessage = $e->getMessage();
                $this->assertEquals($errorMessage, $expectedResult);
            }
        }, [
            'examples' => [

                [// invalid download type
                    "invalid", "template", "No headers found for the template"
                ],
                [// faculty template

                    'faculty',
                    "template",
                    [
                        "ExternalId",
                        "AuthUsername",
                        "Firstname",
                        "Lastname",
                        "Title",
                        "Address1",
                        "Address2",
                        "City",
                        "Zip",
                        "State",
                        "Country",
                        "PrimaryMobile",
                        "AlternateMobile",
                        "OfficePhone",
                        "PrimaryEmail",
                        "AlternateEmail",
                        "IsActive"
                    ]

                ],
                [ // student template
                    'student',
                    'template',
                    [
                        'ExternalId',
                        'Firstname',
                        'Lastname',
                        'PrimaryEmail',
                        'YearId',
                        'TermId',
                        'Participating',
                        'IsActive',
                        'RiskGroupId',
                        'RetentionTrack',
                        'SurveyCohort',
                        'TransitionOneReceiveSurvey',
                        'CheckupOneReceiveSurvey',
                        'TransitionTwoReceiveSurvey',
                        'CheckupTwoReceiveSurvey',
                        'PrimaryConnect',
                        'StudentPhoto',
                        'AuthUsername',
                        'Address1',
                        'Address2',
                        'City',
                        'Zip',
                        'State',
                        'Country',
                        'CampusAddress',
                        'CampusCity',
                        'CampusState',
                        'CampusZip',
                        'CampusCountry',
                        'PrimaryMobile',
                        'PrimaryMobileProvider',
                        'AlternateMobile',
                        'AlternateMobileProvider',
                        'HomePhone',
                        'AlternateEmail',
                        'Gender',
                        'BirthYear',
                        'MiddleName',
                        'RaceEthnicity',
                        'StateInOut',
                        'InternationalStudent',
                        'GuardianEdLevel',
                        'FirstGenStudent',
                        'MilitaryServedUS',
                        'MilitaryBenefitsUS',
                        'CampusResident',
                        'HonorsStudent',
                        'AthleteStudent',
                        'AthleteScholarship',
                        'AthleteSport',
                        'FAFSASubmitted',
                        'FedAidReceived',
                        'PellEligible',
                        'EFC',
                        'UnmetNeed',
                        'HighSchoolNumber',
                        'HighSchoolGPA',
                        'HighSchoolPercentile',
                        'HighSchoolGradYear',
                        'ACTComposite',
                        'ACTEnglish',
                        'ACTMath',
                        'ACTWriting',
                        'ACTScience',
                        'ACTReading',
                        'SATMath',
                        'SATComposite',
                        'SATWriting',
                        'SATCriticalRead',
                        'COMPASSPreAlgebra',
                        'COMPASSAlgebra',
                        'COMPASSCollegeAlgebra',
                        'COMPASSGeometry',
                        'COMPASSTrig',
                        'COMPASSWriting',
                        'COMPASSReading',
                        'COMPASSESL',
                        'ACCUPLACERSentence',
                        'ACCUPLACERArithmetic',
                        'ACCUPLACERAlgebra',
                        'ACCUPLACERReading',
                        'ApplicationDate',
                        'AdmissionDate',
                        'AcceptDate',
                        'OrientationDate',
                        'EnrollYear',
                        'EnrollTerm',
                        'EnrollType',
                        'DegreeSeeking',
                        'IPEDSCohort',
                        'MajorCIP',
                        'ProgramOnline',
                        'StartYearClassLevel',
                        'PreYearCredTotal',
                        'PreYearRemCredEarned',
                        'PreYearCumGPA',
                        'StartTermCredTotal',
                        'StartTermCredRem',
                        'EnrollTimeStatus',
                        'MidCoursesFailing',
                        'EndTermGPA',
                        'EndTermCreditsEarned',
                        'EndTermCumGPA',
                        'EndTermCumCreditsEarned',
                        'EndTermRemCredPass',
                        'SAP',
                        'EnrolledAtBeginningOfAcademicYear',
                        'EnrolledAtMidpointOfAcademicYear',
                        'CompletedADegree',
                        'LevelofCompletion'
                    ]
                ],
                [// faculty data dump
                    'faculty',
                    "data_dump",
                    [
                        'ExternalId',
                        'AuthUsername',
                        'Firstname',
                        'Lastname',
                        'Title',
                        'Address1',
                        'Address2',
                        'City',
                        'Zip',
                        'State',
                        'Country',
                        'PrimaryMobile',
                        'AlternateMobile',
                        'OfficePhone',
                        'PrimaryEmail',
                        'AlternateEmail',
                        'PrimaryMobileProvider',
                        'AlternateMobileProvider',
                        'IsActive'
                    ]
                ],
                [
                    // student data_dump
                    'student',
                    'data_dump',
                    [
                        'ExternalId',
                        'Firstname',
                        'Lastname',
                        'PrimaryEmail',
                        'YearId',
                        'TermId',
                        'Participating',
                        'IsActive',
                        'RiskGroupId',
                        'RetentionTrack',
                        'SurveyCohort',
                        'TransitionOneReceiveSurvey',
                        'CheckupOneReceiveSurvey',
                        'TransitionTwoReceiveSurvey',
                        'CheckupTwoReceiveSurvey',
                        'PrimaryConnect',
                        'StudentPhoto',
                        'AuthUsername',
                        'StudentAuthKey',
                        'IsPrivacyPolicyAccepted',
                        'PrivacyPolicyAcceptedDate',
                        'Address1',
                        'Address2',
                        'City',
                        'Zip',
                        'State',
                        'Country',
                        'CampusAddress',
                        'CampusCity',
                        'CampusState',
                        'CampusZip',
                        'CampusCountry',
                        'PrimaryMobile',
                        'PrimaryMobileProvider',
                        'AlternateMobile',
                        'AlternateMobileProvider',
                        'HomePhone',
                        'AlternateEmail',
                        'Gender',
                        'BirthYear',
                        'MiddleName',
                        'RaceEthnicity',
                        'StateInOut',
                        'InternationalStudent',
                        'GuardianEdLevel',
                        'FirstGenStudent',
                        'MilitaryServedUS',
                        'MilitaryBenefitsUS',
                        'CampusResident',
                        'HonorsStudent',
                        'AthleteStudent',
                        'AthleteScholarship',
                        'AthleteSport',
                        'FAFSASubmitted',
                        'FedAidReceived',
                        'PellEligible',
                        'EFC',
                        'UnmetNeed',
                        'HighSchoolNumber',
                        'HighSchoolGPA',
                        'HighSchoolPercentile',
                        'HighSchoolGradYear',
                        'ACTComposite',
                        'ACTEnglish',
                        'ACTMath',
                        'ACTWriting',
                        'ACTScience',
                        'ACTReading',
                        'SATMath',
                        'SATComposite',
                        'SATWriting',
                        'SATCriticalRead',
                        'COMPASSPreAlgebra',
                        'COMPASSAlgebra',
                        'COMPASSCollegeAlgebra',
                        'COMPASSGeometry',
                        'COMPASSTrig',
                        'COMPASSWriting',
                        'COMPASSReading',
                        'COMPASSESL',
                        'ACCUPLACERSentence',
                        'ACCUPLACERArithmetic',
                        'ACCUPLACERAlgebra',
                        'ACCUPLACERReading',
                        'ApplicationDate',
                        'AdmissionDate',
                        'AcceptDate',
                        'OrientationDate',
                        'EnrollYear',
                        'EnrollTerm',
                        'EnrollType',
                        'DegreeSeeking',
                        'IPEDSCohort',
                        'MajorCIP',
                        'ProgramOnline',
                        'StartYearClassLevel',
                        'PreYearCredTotal',
                        'PreYearRemCredEarned',
                        'PreYearCumGPA',
                        'StartTermCredTotal',
                        'StartTermCredRem',
                        'EnrollTimeStatus',
                        'MidCoursesFailing',
                        'EndTermGPA',
                        'EndTermCreditsEarned',
                        'EndTermCumGPA',
                        'EndTermCumCreditsEarned',
                        'EndTermRemCredPass',
                        'SAP',
                        'EnrolledAtBeginningOfAcademicYear',
                        'EnrolledAtMidpointOfAcademicYear',
                        'CompletedADegree',
                        'LevelofCompletion'
                    ]
                ],
                [// faculty data dump
                    'faculty',
                    "data_definition_file",
                    [
                        'ExternalId',
                        'AuthUsername',
                        'Firstname',
                        'Lastname',
                        'Title',
                        'Address1',
                        'Address2',
                        'City',
                        'Zip',
                        'State',
                        'Country',
                        'PrimaryMobile',
                        'AlternateMobile',
                        'OfficePhone',
                        'PrimaryEmail',
                        'AlternateEmail',
                        'PrimaryMobileProvider',
                        'AlternateMobileProvider',
                        'IsActive'
                    ]
                ],
                [
                    // student data_dump
                    'student',
                    'data_definition_file',
                    [
                        'ExternalId',
                        'Firstname',
                        'Lastname',
                        'PrimaryEmail',
                        'YearId',
                        'TermId',
                        'Participating',
                        'IsActive',
                        'RiskGroupId',
                        'RetentionTrack',
                        'SurveyCohort',
                        'TransitionOneReceiveSurvey',
                        'CheckupOneReceiveSurvey',
                        'TransitionTwoReceiveSurvey',
                        'CheckupTwoReceiveSurvey',
                        'PrimaryConnect',
                        'StudentPhoto',
                        'AuthUsername',
                        'Address1',
                        'Address2',
                        'City',
                        'Zip',
                        'State',
                        'Country',
                        'CampusAddress',
                        'CampusCity',
                        'PrimaryMobile',
                        'CampusState',
                        'PrimaryMobileProvider',
                        'CampusZip',
                        'AlternateMobile',
                        'CampusCountry',
                        'AlternateMobileProvider',
                        'HomePhone',
                        'AlternateEmail',
                        'Gender',
                        'BirthYear',
                        'MiddleName',
                        'RaceEthnicity',
                        'StateInOut',
                        'InternationalStudent',
                        'GuardianEdLevel',
                        'FirstGenStudent',
                        'MilitaryServedUS',
                        'MilitaryBenefitsUS',
                        'CampusResident',
                        'HonorsStudent',
                        'AthleteStudent',
                        'AthleteScholarship',
                        'AthleteSport',
                        'FAFSASubmitted',
                        'FedAidReceived',
                        'PellEligible',
                        'EFC',
                        'UnmetNeed',
                        'HighSchoolNumber',
                        'HighSchoolGPA',
                        'HighSchoolPercentile',
                        'HighSchoolGradYear',
                        'ACTComposite',
                        'ACTEnglish',
                        'ACTMath',
                        'ACTWriting',
                        'ACTScience',
                        'ACTReading',
                        'SATMath',
                        'SATComposite',
                        'SATWriting',
                        'SATCriticalRead',
                        'COMPASSPreAlgebra',
                        'COMPASSAlgebra',
                        'COMPASSCollegeAlgebra',
                        'COMPASSGeometry',
                        'COMPASSTrig',
                        'COMPASSWriting',
                        'COMPASSReading',
                        'COMPASSESL',
                        'ACCUPLACERSentence',
                        'ACCUPLACERArithmetic',
                        'ACCUPLACERAlgebra',
                        'ACCUPLACERReading',
                        'ApplicationDate',
                        'AdmissionDate',
                        'AcceptDate',
                        'OrientationDate',
                        'EnrollYear',
                        'EnrollTerm',
                        'EnrollType',
                        'DegreeSeeking',
                        'IPEDSCohort',
                        'MajorCIP',
                        'ProgramOnline',
                        'StartYearClassLevel',
                        'PreYearCredTotal',
                        'PreYearRemCredEarned',
                        'PreYearCumGPA',
                        'StartTermCredTotal',
                        'StartTermCredRem',
                        'EnrollTimeStatus',
                        'MidCoursesFailing',
                        'EndTermGPA',
                        'EndTermCreditsEarned',
                        'EndTermCumGPA',
                        'EnrolledAtBeginningOfAcademicYear',
                        'EndTermCumCreditsEarned',
                        'EnrolledAtMidpointOfAcademicYear',
                        'EndTermRemCredPass',
                        'CompletedADegree',
                        'SAP',
                        'LevelofCompletion',
                    ]
                ]
            ]
        ]);
    }
}